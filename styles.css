/* === Visual polish: subtle gradients & glass effect === */
.hero{
  background:
    radial-gradient(1200px 500px at 30% -10%, rgba(54,87,255,.25), transparent 60%),
    linear-gradient(180deg, var(--bg-alt), var(--bg));
}
.card, .panel, .toc{
  background: rgba(15,27,61,.55);
  border: 1px solid rgba(255,255,255,.08);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* === Consistent iconography === */
.icon, .concern-svg{ width:24px; height:24px; }
.icon{ fill:#9bb8ff; }
.concern-svg{ stroke:#9bb8ff; }
.high-contrast .icon{ fill:var(--text); }
.high-contrast .concern-svg{ stroke:var(--text); }

/* === Sticky section headers (keeps context visible) === */
section > h2{
  position: sticky;
  top: 72px;
  z-index: 10;
  padding: .4rem .25rem;
  margin: 0 0 var(--space-2);
  background: linear-gradient(180deg, rgba(11,16,32,.85), rgba(11,16,32,.65));
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  border-bottom: 1px solid var(--border);
}

/* === Animated section divider (respects reduced-motion) === */
section > h2::after{
  content:"";
  display:block;
  height:2px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform .5s ease;
}
section.revealed > h2::after{ transform: scaleX(1); }
.reduce-motion section > h2::after{ transition: none; transform: scaleX(1); }

/* === WCAG badge === */
.compliance{ max-width: var(--maxw); margin:.5rem auto 0; padding:0 var(--space-2); }
.wcag-badge{
  display:inline-block; padding:.25rem .5rem; border-radius:999px;
  border:1px solid var(--border); background:#0b1440; color:var(--text);
  text-decoration:none; font-size:.75rem; letter-spacing:.02em;
}
/* === Accessibility/Theme Enhancements (append to end of file) === */

/* High-contrast theme driven by a class on <html>.
   We override the design tokens (CSS variables) so the whole UI updates. */
:root.high-contrast {
  --bg: #000;
  --bg-alt: #000;
  --text: #ffffff;
  --muted: #e6e6e6;
  --primary: #ffffff;
  --accent: #ffff00;
  --border: #ffffff;
  --focus: #00ffff;
}

/* Make borders and focus rings more visible in HC mode */
.high-contrast .data-table,
.high-contrast .card,
.high-contrast .panel,
.high-contrast .toc {
  border-color: var(--border) !important;
  box-shadow: none !important;
}
.high-contrast :focus-visible {
  outline-color: var(--focus) !important;
}
.high-contrast .icon,
.high-contrast .concern-svg {
  stroke: var(--text);
  fill: var(--text);
}
.high-contrast .badge.positive { color: #00ff00; }
.high-contrast .badge.negative { color: #ff4444; }

/* Reduced motion: disable transitions/animations site-wide and avoid smooth scroll */
.reduce-motion *,
.reduce-motion *::before,
.reduce-motion *::after {
  animation: none !important;
  transition: none !important;
  scroll-behavior: auto !important;
}

/* Chart text is always readable against backgrounds */
.chart svg text { fill: var(--text); }

/* Action buttons: compact style with spacing */
.figure-actions {
  display: flex;
  flex-wrap: wrap;
  gap: .4rem;
  margin-top: .75rem;       /* push buttons away from stats/cards */
}
.figure-actions .action-btn {
  padding: .2rem .5rem !important;
  border-radius: 6px !important;
  font-size: .8rem !important;
  line-height: 1.2 !important;
  min-width: auto !important;
  display: inline-block !important;
  background: #111a3b;
}

/* Tweak tooltip legibility in dark + HC modes */
.tooltip {
  background: rgba(0,0,0,.85);
  color: var(--text);
  border: 1px solid var(--border);
}
.high-contrast .tooltip {
  background: #000 !important;
  border-color: #fff !important;
  color: #fff !important;
}
/* Base */
:root {
  --bg: #0b1020;
  --bg-alt: #0f172a;
  --text: #e5e7eb;
  --muted: #cbd5e1;
  --primary: #3657ff;
  --accent: #f59e0b;
  --border: #1f2937;
  --focus: #0ea5e9;
  --positive: #17a34a;
  --negative: #cf3030;
  --radius: 16px;
  --space-1:.5rem; --space-2:1rem; --space-3:1.5rem; --space-4:2rem;
  --maxw: 1100px;
  --font-sans: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial,sans-serif;
  --font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  --font: var(--font-sans);
}
*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{
  margin:0; background:var(--bg); color:var(--text); font-family:var(--font); line-height:1.6;
}
img,svg{display:block; max-width:100%}
a{color:#9bb8ff; text-underline-offset:2px}
.sr-only{position:absolute!important;width:1px;height:1px;clip:rect(0 0 0 0);overflow:hidden;white-space:nowrap}
.skip-link{position:absolute;left:8px;top:-40px;background:#111;color:#fff;padding:.5rem .75rem;border-radius:8px;z-index:1000}
.skip-link:focus{top:8px}

:focus-visible{outline:3px solid var(--focus); outline-offset:3px; border-radius:8px}

/* Header & hero */
.topbar{max-width:var(--maxw);margin:0 auto;padding:.5rem var(--space-2);display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:center;border-bottom:1px solid var(--border)}
.brand{display:flex;gap:.6rem;align-items:center}
.logo{border-radius:50%}
.brand-name{font-weight:700}
.topnav{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}
.lang-btn,.toggle,.action-btn{border:1px solid var(--border);background:#111a3a;color:var(--text);padding:.5rem .75rem;border-radius:999px;cursor:pointer}
.select{border:1px solid var(--border);background:#111a3a;color:var(--text);padding:.5rem .75rem;border-radius:8px}

.hero{border-bottom:1px solid var(--border);background:linear-gradient(180deg,var(--bg-alt),var(--bg))}
.hero-content{max-width:var(--maxw);margin:0 auto;padding:var(--space-4) var(--space-2);display:grid;grid-template-columns:1fr 280px;gap:1rem;align-items:start}
.title{margin:0 0 .25rem;font-size:clamp(2rem,3vw + 1rem,3rem)}
.subtitle,.date{margin:0;color:var(--muted)}

.toc{position:sticky;top:0;border:1px solid var(--border);border-radius:12px;padding:.5rem;background:#0e1535}
.toc ul{display:flex;flex-direction:column;gap:.35rem;list-style:none;margin:0;padding:0}
.toc a{display:inline-block;padding:.25rem .5rem;border-radius:999px;background:#0b1440;border:1px solid var(--border);color:var(--text);text-decoration:none}

/* Layout */
main{max-width:var(--maxw);margin:0 auto;padding:var(--space-4) var(--space-2)}
section{scroll-margin-top:80px}
/* === Glass & gradient polish === */
.hero{background:
  radial-gradient(1200px 500px at 30% -10%, rgba(54,87,255,.25), transparent 60%),
  linear-gradient(180deg, var(--bg-alt), var(--bg));}
.card,.panel,.toc{background:rgba(15,27,61,.55);border:1px solid rgba(255,255,255,.08);
  backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);}
.icon,.concern-svg{width:24px;height:24px}
.icon{fill:#9bb8ff}.concern-svg{stroke:#9bb8ff}
.high-contrast .icon{fill:var(--text)}.high-contrast .concern-svg{stroke:var(--text)}
/* === Sticky section headers (safer top, with shadow) === */
section>h2{position:sticky;top:12px;z-index:10;padding:.35rem .25rem;margin:0 0 var(--space-2);
  background:linear-gradient(180deg,rgba(11,16,32,.95),rgba(11,16,32,.75));backdrop-filter:blur(4px);
  -webkit-backdrop-filter:blur(4px);border-bottom:1px solid var(--border);box-shadow:0 6px 12px rgba(0,0,0,.18)}
/* === Animated divider (respects reduced motion) === */
section>h2::after{content:"";display:block;height:2px;background:linear-gradient(90deg,var(--primary),var(--accent));
  transform:scaleX(0);transform-origin:left;transition:transform .45s ease}
section.revealed>h2::after{transform:scaleX(1)}.reduce-motion section>h2::after{transition:none;transform:scaleX(1)}
/* ensure content isn't hidden under sticky headers when jumping by anchors */
section{scroll-margin-top:96px}
/* WCAG badge */
.compliance{max-width:var(--maxw);margin:1rem auto 1.25rem;padding:0 var(--space-2)}
.wcag-badge{display:inline-block;padding:.35rem .65rem;border-radius:999px;border:1px solid var(--border);
  background:#0b1440;color:var(--text);text-decoration:none;font-size:.75rem;letter-spacing:.02em}
 
h2{margin:0 0 var(--space-2); font-size:clamp(1.4rem,1.5vw + 1rem,2rem)}
h3{margin:.25rem 0 .5rem; font-size:1.1rem}

/* Cards */
.cards{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--space-2)}
.card{background:#0f1b3d;border:1px solid var(--border);border-radius:var(--radius);padding:var(--space-2);box-shadow:0 8px 24px rgba(0,0,0,.2)}
.card-media{width:36px;height:36px}
.icon{fill:#9bb8ff}
.card-title{color:var(--muted)}
.card-value{font-weight:800;font-size:2rem}
/* Micro-animations (disabled when Reduce motion is ON) */
.card{transition: transform .18s ease, box-shadow .18s ease}
.card:hover{transform: translateY(-2px); box-shadow:0 12px 28px rgba(0,0,0,.35)}
.reduce-motion .card:hover{transform:none !important; box-shadow:0 8px 24px rgba(0,0,0,.2) !important}

/* Figure actions */
.section-head{display:flex;justify-content:space-between;gap:1rem;flex-wrap:wrap}
.figure-actions{display:flex;gap:.5rem}

/* Tables */
.table-wrapper{overflow-x:auto}
.data-table{width:100%;min-width:520px;border:1px solid var(--border);border-radius:12px;border-collapse:separate;border-spacing:0;background:#0f1b3d}
.data-table th,.data-table td{padding:.8rem 1rem;border-bottom:1px solid var(--border);text-align:left}
.data-table thead th{background:#0b1440}

/* Badges */
.badge{display:inline-flex;gap:.35rem;align-items:center;padding:.2rem .5rem;border-radius:999px;border:1px solid currentColor}
.badge.positive{color:var(--positive)}
.badge.negative{color:var(--negative)}

.note{color:var(--muted)}

/* Grid panels */
.grid.two{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-2)}
.panel{background:#0f1b3d;border:1px solid var(--border);border-radius:var(--radius);padding:var(--space-2)}

.quotes{padding-left:1rem}

/* Concerns */
.concern-list{list-style:none;margin:0;padding:0;display:grid;gap:.5rem}
.concern-list li{display:flex;align-items:center;gap:.6rem;background:#0f1b3d;border:1px solid var(--border);border-radius:var(--radius);padding:.6rem .8rem}
.concern-svg{width:20px;height:20px;fill:none;stroke:#9bb8ff;stroke-width:2}

/* Charts */
.chart svg{width:100%;height:auto}
.chart svg text{fill:var(--text);font-size:12px}
.chart .bar rect{fill:#3657ff}
.chart .bar rect.series-2{fill:#f59e0b;opacity:.9}

.tooltip{position:fixed;left:0;top:0;background:#0b1440;color:var(--text);border:1px solid var(--border);border-radius:8px;padding:.25rem .5rem;box-shadow:0 10px 30px rgba(0,0,0,.4);display:none;pointer-events:none;z-index:1000}

/* Footer */
.site-footer{border-top:1px solid var(--border);margin-top:var(--space-4);padding-bottom:var(--space-4)}
.footer-grid{max-width:var(--maxw);margin:0 auto;padding:var(--space-3) var(--space-2);display:grid;gap:var(--space-2);grid-template-columns:repeat(3,1fr)}
.footer-links{list-style:none;display:flex;gap:1rem;margin:0;padding:0}
.muted{color:var(--muted)}

/* Back to top */
.back-to-top{position:fixed;right:16px;bottom:16px;background:#3657ff;color:#fff;border:0;border-radius:999px;width:48px;height:48px;box-shadow:0 8px 24px rgba(0,0,0,.35);cursor:pointer;opacity:0;pointer-events:none;transition:opacity .2s ease}
.back-to-top.show{opacity:1;pointer-events:auto}

/* Typography toggles */
.font-serif{--font:var(--font-serif)}
.font-mono{--font:var(--font-mono)}

/* Responsive charts */
.chart{max-width:100%}
.chart svg{max-width:100%;height:auto}
.chart canvas{max-width:100%!important;height:auto!important}
/* Generic div-bar support (if bars are HTML) */
.chart .bar{height:14px;margin:.25rem 0;border-radius:4px}
.chart .bar .value{font-weight:600}
.chart .axis text{fill:var(--text)}
.chart .series text{fill:var(--text)}

/* Responsive data tables */
.data-table{width:100%;table-layout:auto}
.data-table th,.data-table td{white-space:normal;word-break:break-word}
.table-wrap,.table-responsive{max-width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}

@media (max-width:900px){
  .data-table{table-layout:fixed}
  .data-table th,.data-table td{word-break:break-word}
}

@media (max-width:640px){
  .back-to-top{bottom:76px}
  .topbar{grid-template-columns:1fr;gap:.5rem;padding:.5rem var(--space-2)}
  .topnav{display:flex;flex-wrap:wrap;gap:.35rem;align-items:center}
  .lang-btn,.toggle,.select{padding:.35rem .5rem;font-size:.85rem;border-radius:12px}
  .hero-content{padding:var(--space-3) var(--space-2);grid-template-columns:1fr}
  .toc{position:static;margin-top:.75rem;border-radius:14px}
  .toc ul{flex-direction:row;flex-wrap:wrap;gap:.4rem}
  section>h2{top:8px;padding:.3rem .25rem}
  .footer-grid{grid-template-columns:1fr;row-gap:.75rem;padding:var(--space-3) var(--space-2)}
  .compliance{margin:1rem 0 1.25rem;padding:0 var(--space-2)}
  .panel{overflow:visible}
  .data-table{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;table-layout:fixed}
  .data-table th,.data-table td{padding:.6rem .5rem;white-space:normal;word-break:break-word}
  .data-table th{font-size:.9rem}
  .data-table td{font-size:.9rem}
  .badge{font-size:.85rem;white-space:normal}
  .figure-actions{margin-top:.5rem}
  .chart{max-width:100%;margin:.5rem 0}
  .chart svg{max-width:100%;height:auto}
  .chart canvas{max-width:100%!important;height:auto!important}
  .chart .bar{height:18px;margin:.35rem 0;border-radius:4px}
  .chart text,.chart .label,.chart .bar .value{font-size:.72rem}
  /* Charts on mobile: more breathing room and readable labels */
  .figure-actions{margin-top:.5rem}
  .chart .bar{height:16px;margin:.35rem 0}
  .chart text,.chart .label,.chart .bar .value{font-size:.78rem}
  /* Make any table horizontally scrollable if too wide */
  .data-table{display:block;overflow-x:auto}
}

@media (max-width:900px){
  .cards{grid-template-columns:1fr}
  .grid.two{grid-template-columns:1fr}
  .hero-content{grid-template-columns:1fr}
}

/* Section heading accent refinement */
section>h2{
  letter-spacing:.2px;
  text-shadow:0 1px 0 rgba(0,0,0,.25);
}
section>h2::after{
  height:3px;
  background:linear-gradient(90deg, rgba(91,122,255,.9), rgba(255,171,64,.9));
  opacity:.9;
}

/* Consistent badge sizing (chips, sentiment pills, etc.) */
.badge{
  display:inline-flex;
  align-items:center;
  gap:.35rem;
  padding:.28rem .6rem;
  border-radius:999px;
  line-height:1;
  font-size:.9rem;
}
@media (max-width:640px){
  .badge{font-size:.85rem;padding:.26rem .55rem}
}
.high-contrast .badge{border:1px solid var(--border)}

/* Consistent card/panel density and grid gaps */
.cards{gap:clamp(.75rem, .6rem + .6vw, 1.25rem)}
.card,.panel,.toc{
  padding:clamp(.85rem, .75rem + .6vw, 1.25rem) !important;
  border-radius:16px;
}
@media (max-width:640px){
  .card,.panel,.toc{
    padding:clamp(.75rem, .7rem + .4vw, 1rem) !important;
    border-radius:14px;
  }
}

/* Chip/button sizing harmony */
.lang-btn,.toggle,.select,.action-btn{
  border-radius:12px;
  padding:.35rem .6rem;
  line-height:1.1;
}
@media (max-width:640px){
  .lang-btn,.toggle,.select,.action-btn{
    padding:.33rem .55rem;
    font-size:.9rem;
  }
}
/* Mobile-first fixes for any SVG-based charts (stronger specificity + !important) */
@media (max-width:640px){
  .figure, .chart, .chart-container { width:100%; }
  .figure svg, .chart svg, .chart-container svg {
    display:block;
    width:100% !important;
    height:auto !important;
    min-height:140px !important;
    overflow:visible !important;
  }
  /* Common class fallbacks for horizontal-bar containers */
  .hbars svg, .bars svg, .bar-chart svg { min-height:160px !important; }
  /* Make all SVG text legible on phones */
  .figure svg text,
  .chart svg text,
  .chart-container svg text,
  .hbars svg text,
  .bars svg text,
  .bar-chart svg text {
    font-size:0.9rem !important;
    paint-order:stroke fill;
    stroke:#0b1440;
    stroke-width:2px;
  }
  /* If tiny values are drawn inside bars, hide them to avoid clutter */
  .figure svg .value,
  .chart svg .value,
  .chart .label-inline {
    display:none !important;
  }
}
@media (max-width:640px){
  .chart{max-width:100%;margin:.75rem 0 1rem}
  .chart svg{max-width:100%;height:auto;overflow:visible}
  .chart canvas{max-width:100%!important;height:auto!important}
  .chart .bar{height:22px;margin:.4rem 0;border-radius:4px}
  .chart text{
    font-size:.85rem;
    paint-order:stroke fill;
    stroke:#0b1440;
    stroke-width:2;
  }
  /* suppress tiny inline values that crowd the bars on small screens */
  .chart .value,
  .chart .bar .value,
  .chart .label-inline{display:none}
}